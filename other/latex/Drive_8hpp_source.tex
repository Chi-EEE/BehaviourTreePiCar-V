\hypertarget{Drive_8hpp_source}{}\doxysection{Drive.\+hpp}
\label{Drive_8hpp_source}\index{behaviour\_tree\_car/include/behaviour\_tree/node/custom/action/Drive.hpp@{behaviour\_tree\_car/include/behaviour\_tree/node/custom/action/Drive.hpp}}
\mbox{\hyperlink{Drive_8hpp}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{preprocessor}{\#ifndef BEHAVIOUR\_TREE\_DRIVE\_HPP}}
\DoxyCodeLine{2 \textcolor{preprocessor}{\#define BEHAVIOUR\_TREE\_DRIVE\_HPP}}
\DoxyCodeLine{3 }
\DoxyCodeLine{4 \textcolor{preprocessor}{\#pragma once}}
\DoxyCodeLine{5 }
\DoxyCodeLine{6 \textcolor{preprocessor}{\#include <fmt/format.h>}}
\DoxyCodeLine{7 }
\DoxyCodeLine{8 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{CustomNode_8hpp}{behaviour\_tree/node/custom/CustomNode.hpp}}"{}}}
\DoxyCodeLine{9 }
\DoxyCodeLine{10 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{Context_8h}{behaviour\_tree/Context.h}}"{}}}
\DoxyCodeLine{11 \textcolor{preprocessor}{\#ifndef BEHAVIOUR\_TREE\_DISABLE\_RUN}}
\DoxyCodeLine{12 \textcolor{preprocessor}{\#include "{}behaviour\_tree/CarContext.hpp"{}}}
\DoxyCodeLine{13 \textcolor{preprocessor}{\#endif }\textcolor{comment}{// !BEHAVIOUR\_TREE\_DISABLE\_RUN}}
\DoxyCodeLine{14 }
\DoxyCodeLine{15 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{DirectionType_8hpp}{enum/DirectionType.hpp}}"{}}}
\DoxyCodeLine{16 }
\DoxyCodeLine{17 \textcolor{keyword}{namespace }\mbox{\hyperlink{namespacebehaviour__tree_1_1node_1_1custom_1_1action}{behaviour\_tree::node::custom::action}}}
\DoxyCodeLine{18 \{}
\DoxyCodeLine{19     \textcolor{keyword}{class }\mbox{\hyperlink{classbehaviour__tree_1_1node_1_1custom_1_1action_1_1Drive}{Drive}} final : \textcolor{keyword}{public} \mbox{\hyperlink{classbehaviour__tree_1_1node_1_1custom_1_1CustomNode}{CustomNode}}}
\DoxyCodeLine{20     \{}
\DoxyCodeLine{21     \textcolor{keyword}{public}:}
\DoxyCodeLine{22         \mbox{\hyperlink{classbehaviour__tree_1_1node_1_1custom_1_1action_1_1Drive_a8dcbee9d824c856bbb4d7b5c23a68cd8}{Drive}}(\textcolor{keyword}{const} std::string \&\mbox{\hyperlink{classbehaviour__tree_1_1node_1_1Node_a24780ba4a95e7495222ead3390bddd35}{name}}, \textcolor{keyword}{const} \textcolor{keywordtype}{int} \mbox{\hyperlink{classbehaviour__tree_1_1node_1_1custom_1_1action_1_1Drive_a8bb264c4d1713fdc7f23b6d9254a9eec}{speed}}, \textcolor{keyword}{const} \mbox{\hyperlink{namespacebehaviour__tree_1_1node_1_1custom_1_1action_a22445d94efe9963bf500cc98f89ce1ab}{DirectionType}} \mbox{\hyperlink{classbehaviour__tree_1_1node_1_1custom_1_1action_1_1Drive_a3bed194a0a57298276c7499131d9408c}{direction\_type}}) : \mbox{\hyperlink{classbehaviour__tree_1_1node_1_1custom_1_1CustomNode}{CustomNode}}(\mbox{\hyperlink{classbehaviour__tree_1_1node_1_1Node_a24780ba4a95e7495222ead3390bddd35}{name}}), \mbox{\hyperlink{classbehaviour__tree_1_1node_1_1custom_1_1action_1_1Drive_a8bb264c4d1713fdc7f23b6d9254a9eec}{speed}}(\mbox{\hyperlink{classbehaviour__tree_1_1node_1_1custom_1_1action_1_1Drive_a8bb264c4d1713fdc7f23b6d9254a9eec}{speed}}), \mbox{\hyperlink{classbehaviour__tree_1_1node_1_1custom_1_1action_1_1Drive_a3bed194a0a57298276c7499131d9408c}{direction\_type}}(\mbox{\hyperlink{classbehaviour__tree_1_1node_1_1custom_1_1action_1_1Drive_a3bed194a0a57298276c7499131d9408c}{direction\_type}})}
\DoxyCodeLine{23         \{}
\DoxyCodeLine{24         \}}
\DoxyCodeLine{25 }
\DoxyCodeLine{26         \textcolor{keyword}{const} \textcolor{keyword}{static} tl::expected<std::shared\_ptr<Drive>, std::string> \mbox{\hyperlink{classbehaviour__tree_1_1node_1_1custom_1_1action_1_1Drive_a18270f00a2ef9e55872ae0f347ff4807}{parse}}(\textcolor{keyword}{const} pugi::xml\_node \&node, \textcolor{keyword}{const} \textcolor{keywordtype}{int} index, \textcolor{keyword}{const} std::string \&name\_attribute)}
\DoxyCodeLine{27         \{}
\DoxyCodeLine{28             \textcolor{keyword}{const} \textcolor{keywordtype}{int} \mbox{\hyperlink{classbehaviour__tree_1_1node_1_1custom_1_1action_1_1Drive_a8bb264c4d1713fdc7f23b6d9254a9eec}{speed}} = node.attribute(\textcolor{stringliteral}{"{}speed"{}}).as\_int();}
\DoxyCodeLine{29             \textcolor{keywordflow}{if} (speed < 0 || speed > 100)}
\DoxyCodeLine{30             \{}
\DoxyCodeLine{31                 \textcolor{keywordflow}{return} tl::unexpected(fmt::format(R\textcolor{stringliteral}{"{}(Invalid speed: '\{\}' | Action:Drive:['\{\}',\{\}])"{}, \mbox{\hyperlink{classbehaviour__tree_1_1node_1_1custom_1_1action_1_1Drive_a8bb264c4d1713fdc7f23b6d9254a9eec}{speed}}, name\_attribute, index));}}
\DoxyCodeLine{32 \textcolor{stringliteral}{            \}}}
\DoxyCodeLine{33 \textcolor{stringliteral}{            }\textcolor{keyword}{const} tl::expected<DirectionType, std::string> maybe\_direction\_type =}
\DoxyCodeLine{34                 [\&]()}
\DoxyCodeLine{35             \{}
\DoxyCodeLine{36                 \textcolor{keyword}{const} std::string direction\_type\_attribute = node.attribute(\textcolor{stringliteral}{"{}direction\_type"{}}).as\_string();}
\DoxyCodeLine{37                 tl::expected<DirectionType, std::string> result;}
\DoxyCodeLine{38                 \textcolor{keywordflow}{switch} (utils::hash(direction\_type\_attribute))}
\DoxyCodeLine{39                 \{}
\DoxyCodeLine{40                 \textcolor{keywordflow}{case} utils::hash(\textcolor{stringliteral}{"{}Forward"{}}):}
\DoxyCodeLine{41                 \{}
\DoxyCodeLine{42                     result = \mbox{\hyperlink{namespacebehaviour__tree_1_1node_1_1custom_1_1action_a22445d94efe9963bf500cc98f89ce1aba67d2f6740a8eaebf4d5c6f79be8da481}{DirectionType::Forward}};}
\DoxyCodeLine{43                     \textcolor{keywordflow}{break};}
\DoxyCodeLine{44                 \}}
\DoxyCodeLine{45                 \textcolor{keywordflow}{case} utils::hash(\textcolor{stringliteral}{"{}Backward"{}}):}
\DoxyCodeLine{46                 \{}
\DoxyCodeLine{47                     result = \mbox{\hyperlink{namespacebehaviour__tree_1_1node_1_1custom_1_1action_a22445d94efe9963bf500cc98f89ce1abab3263eb38f8903efc271cc7a760da510}{DirectionType::Backward}};}
\DoxyCodeLine{48                     \textcolor{keywordflow}{break};}
\DoxyCodeLine{49                 \}}
\DoxyCodeLine{50                 \textcolor{keywordflow}{default}:}
\DoxyCodeLine{51                 \{}
\DoxyCodeLine{52                     result = tl::make\_unexpected(fmt::format(R\textcolor{stringliteral}{"{}(Invalid direction\_type: '\{\}' | Action:Drive:['\{\}',\{\}])"{}, direction\_type\_attribute, name\_attribute, index));}}
\DoxyCodeLine{53 \textcolor{stringliteral}{                    }\textcolor{keywordflow}{break};}
\DoxyCodeLine{54                 \}}
\DoxyCodeLine{55                 \};}
\DoxyCodeLine{56                 \textcolor{keywordflow}{return} result;}
\DoxyCodeLine{57             \}();}
\DoxyCodeLine{58             \textcolor{keywordflow}{if} (!maybe\_direction\_type.has\_value())}
\DoxyCodeLine{59             \{}
\DoxyCodeLine{60                 \textcolor{keywordflow}{return} tl::make\_unexpected(maybe\_direction\_type.error());}
\DoxyCodeLine{61             \}}
\DoxyCodeLine{62             \textcolor{keywordflow}{return} std::make\_shared<Drive>(}
\DoxyCodeLine{63                 \mbox{\hyperlink{classbehaviour__tree_1_1node_1_1custom_1_1action_1_1Drive}{Drive}}(}
\DoxyCodeLine{64                     name\_attribute,}
\DoxyCodeLine{65                     \mbox{\hyperlink{classbehaviour__tree_1_1node_1_1custom_1_1action_1_1Drive_a8bb264c4d1713fdc7f23b6d9254a9eec}{speed}},}
\DoxyCodeLine{66                     maybe\_direction\_type.value()));}
\DoxyCodeLine{67         \}}
\DoxyCodeLine{68 }
\DoxyCodeLine{69         \textcolor{keyword}{const} \mbox{\hyperlink{namespacebehaviour__tree_acc43ccc4dd130eee1c630b2acc709997}{Status}} \mbox{\hyperlink{classbehaviour__tree_1_1node_1_1custom_1_1action_1_1Drive_ae64f5582f82bf34ddcc8013737b46bda}{run}}(\textcolor{keyword}{const} \textcolor{keywordtype}{int} tick\_count, std::shared\_ptr<Context> context) \textcolor{keyword}{final} \textcolor{keyword}{override}}
\DoxyCodeLine{70         \{}
\DoxyCodeLine{71 \textcolor{preprocessor}{\#ifndef BEHAVIOUR\_TREE\_DISABLE\_RUN}}
\DoxyCodeLine{72             std::shared\_ptr<CarContext> car\_context = std::dynamic\_pointer\_cast<CarContext>(context);}
\DoxyCodeLine{73             \textcolor{keyword}{auto} car\_system = car\_context-\/>getCarSystem();}
\DoxyCodeLine{74             \textcolor{keyword}{const} MovementSystem *movement\_system = car\_system-\/>getMovementSystem();}
\DoxyCodeLine{75             \textcolor{keywordflow}{switch} (this-\/>\mbox{\hyperlink{classbehaviour__tree_1_1node_1_1custom_1_1action_1_1Drive_a6ddb5d2cfd55f7134ca00d51b66be77c}{getDirectionType}}())}
\DoxyCodeLine{76             \{}
\DoxyCodeLine{77             \textcolor{keywordflow}{case} \mbox{\hyperlink{namespacebehaviour__tree_1_1node_1_1custom_1_1action_a22445d94efe9963bf500cc98f89ce1abab3263eb38f8903efc271cc7a760da510}{DirectionType::Backward}}:}
\DoxyCodeLine{78             \{}
\DoxyCodeLine{79                 movement\_system-\/>setRearWheelsDirectionToBackward();}
\DoxyCodeLine{80                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{81             \}}
\DoxyCodeLine{82             \textcolor{keywordflow}{case} \mbox{\hyperlink{namespacebehaviour__tree_1_1node_1_1custom_1_1action_a22445d94efe9963bf500cc98f89ce1aba67d2f6740a8eaebf4d5c6f79be8da481}{DirectionType::Forward}}:}
\DoxyCodeLine{83             \{}
\DoxyCodeLine{84                 movement\_system-\/>setRearWheelsDirectionToForward();}
\DoxyCodeLine{85                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{86             \}}
\DoxyCodeLine{87             \}}
\DoxyCodeLine{88             movement\_system-\/>setRearWheelsSpeed(this-\/>\mbox{\hyperlink{classbehaviour__tree_1_1node_1_1custom_1_1action_1_1Drive_a02eae7935b1871991a9955d3da3dbc91}{getSpeed}}());}
\DoxyCodeLine{89 \textcolor{preprocessor}{\#endif }\textcolor{comment}{// !BEHAVIOUR\_TREE\_DISABLE\_RUN}}
\DoxyCodeLine{90             \textcolor{keywordflow}{return} \mbox{\hyperlink{namespacebehaviour__tree_acc43ccc4dd130eee1c630b2acc709997a505a83f220c02df2f85c3810cd9ceb38}{Status::Success}};}
\DoxyCodeLine{91         \}}
\DoxyCodeLine{92 }
\DoxyCodeLine{93         \textcolor{keyword}{const} std::string \mbox{\hyperlink{classbehaviour__tree_1_1node_1_1custom_1_1action_1_1Drive_a40cbf7c23736406403b10118d0381a45}{toString}}() const final\textcolor{keyword}{ override}}
\DoxyCodeLine{94 \textcolor{keyword}{        }\{}
\DoxyCodeLine{95             \textcolor{keyword}{const} std::string \&\mbox{\hyperlink{classbehaviour__tree_1_1node_1_1Node_a24780ba4a95e7495222ead3390bddd35}{name}} = this-\/>\mbox{\hyperlink{classbehaviour__tree_1_1node_1_1Node_ad9b3324377c0a8e45bf05999664aa263}{getName}}();}
\DoxyCodeLine{96             std::string \mbox{\hyperlink{classbehaviour__tree_1_1node_1_1custom_1_1action_1_1Drive_a3bed194a0a57298276c7499131d9408c}{direction\_type}};}
\DoxyCodeLine{97             \textcolor{keywordflow}{switch} (this-\/>\mbox{\hyperlink{classbehaviour__tree_1_1node_1_1custom_1_1action_1_1Drive_a6ddb5d2cfd55f7134ca00d51b66be77c}{getDirectionType}}())}
\DoxyCodeLine{98             \{}
\DoxyCodeLine{99             \textcolor{keywordflow}{case} \mbox{\hyperlink{namespacebehaviour__tree_1_1node_1_1custom_1_1action_a22445d94efe9963bf500cc98f89ce1aba67d2f6740a8eaebf4d5c6f79be8da481}{DirectionType::Forward}}:}
\DoxyCodeLine{100                 direction\_type = \textcolor{stringliteral}{"{}Forward"{}};}
\DoxyCodeLine{101                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{102             \textcolor{keywordflow}{case} \mbox{\hyperlink{namespacebehaviour__tree_1_1node_1_1custom_1_1action_a22445d94efe9963bf500cc98f89ce1abab3263eb38f8903efc271cc7a760da510}{DirectionType::Backward}}:}
\DoxyCodeLine{103                 \mbox{\hyperlink{classbehaviour__tree_1_1node_1_1custom_1_1action_1_1Drive_a3bed194a0a57298276c7499131d9408c}{direction\_type}} = \textcolor{stringliteral}{"{}Backward"{}};}
\DoxyCodeLine{104                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{105             \}}
\DoxyCodeLine{106             \textcolor{keywordflow}{if} (\mbox{\hyperlink{classbehaviour__tree_1_1node_1_1Node_a24780ba4a95e7495222ead3390bddd35}{name}} != \textcolor{stringliteral}{"{}"{}})}
\DoxyCodeLine{107                 \textcolor{keywordflow}{return} fmt::format(R\textcolor{stringliteral}{"{}(<Action:Drive name='\{\}' speed='\{\}' direction\_type='\{\}'/>)"{}, \mbox{\hyperlink{classbehaviour__tree_1_1node_1_1Node_a24780ba4a95e7495222ead3390bddd35}{name}}, this-\/>\mbox{\hyperlink{classbehaviour__tree_1_1node_1_1custom_1_1action_1_1Drive_a02eae7935b1871991a9955d3da3dbc91}{getSpeed}}(), direction\_type);}}
\DoxyCodeLine{108 \textcolor{stringliteral}{            }\textcolor{keywordflow}{else}}
\DoxyCodeLine{109                 \textcolor{keywordflow}{return} fmt::format(R\textcolor{stringliteral}{"{}(<Action:Drive speed='\{\}' direction\_type='\{\}'/>)"{}, this-\/>\mbox{\hyperlink{classbehaviour__tree_1_1node_1_1custom_1_1action_1_1Drive_a02eae7935b1871991a9955d3da3dbc91}{getSpeed}}(), direction\_type);}}
\DoxyCodeLine{110 \textcolor{stringliteral}{        \}}}
\DoxyCodeLine{111 \textcolor{stringliteral}{}}
\DoxyCodeLine{112 \textcolor{stringliteral}{        }\textcolor{keyword}{const} \textcolor{keywordtype}{int} \mbox{\hyperlink{classbehaviour__tree_1_1node_1_1custom_1_1action_1_1Drive_a02eae7935b1871991a9955d3da3dbc91}{getSpeed}}()\textcolor{keyword}{ const}}
\DoxyCodeLine{113 \textcolor{keyword}{        }\{}
\DoxyCodeLine{114             \textcolor{keywordflow}{return} this-\/>\mbox{\hyperlink{classbehaviour__tree_1_1node_1_1custom_1_1action_1_1Drive_a8bb264c4d1713fdc7f23b6d9254a9eec}{speed}};}
\DoxyCodeLine{115         \}}
\DoxyCodeLine{116 }
\DoxyCodeLine{117         \textcolor{keyword}{const} \mbox{\hyperlink{namespacebehaviour__tree_1_1node_1_1custom_1_1action_a22445d94efe9963bf500cc98f89ce1ab}{DirectionType}} \mbox{\hyperlink{classbehaviour__tree_1_1node_1_1custom_1_1action_1_1Drive_a6ddb5d2cfd55f7134ca00d51b66be77c}{getDirectionType}}()\textcolor{keyword}{ const}}
\DoxyCodeLine{118 \textcolor{keyword}{        }\{}
\DoxyCodeLine{119             \textcolor{keywordflow}{return} this-\/>\mbox{\hyperlink{classbehaviour__tree_1_1node_1_1custom_1_1action_1_1Drive_a3bed194a0a57298276c7499131d9408c}{direction\_type}};}
\DoxyCodeLine{120         \}}
\DoxyCodeLine{121 }
\DoxyCodeLine{122     \textcolor{keyword}{private}:}
\DoxyCodeLine{123         \textcolor{keyword}{const} \textcolor{keywordtype}{int} \mbox{\hyperlink{classbehaviour__tree_1_1node_1_1custom_1_1action_1_1Drive_a8bb264c4d1713fdc7f23b6d9254a9eec}{speed}};}
\DoxyCodeLine{124         \textcolor{keyword}{const} \mbox{\hyperlink{namespacebehaviour__tree_1_1node_1_1custom_1_1action_a22445d94efe9963bf500cc98f89ce1ab}{DirectionType}} \mbox{\hyperlink{classbehaviour__tree_1_1node_1_1custom_1_1action_1_1Drive_a3bed194a0a57298276c7499131d9408c}{direction\_type}};}
\DoxyCodeLine{125     \};}
\DoxyCodeLine{126 \}}
\DoxyCodeLine{127 }
\DoxyCodeLine{128 \textcolor{preprocessor}{\#endif}}

\end{DoxyCode}
